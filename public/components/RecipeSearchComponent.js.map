{"version":3,"sources":["components/RecipeSearchComponent.js"],"names":["window","FC","undefined","RecipeSearchComponent","state","baseUri","results","form","offset","query","handleScroll","bind","storedSearch","dietData","getCurrentSearch","data","setState","base","offSet","addEventListener","removeEventListener","windowHeight","innerHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","pageYOffset","queryStr","offsetAmt","console","log","$","ajax","url","type","beforeSend","xhr","setRequestHeader","done","storeCurrentSearch","concatRecipes","concat","evt","preventDefault","queryInput","value","deleteCurrentSearch","searchForm","searchResults","imageUrl","input","callSearch","map","recipe","index","image","id","title","readyInMinutes","React","Component"],"mappings":"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","file":"RecipeSearchComponent.js","sourcesContent":["if (window.FC === undefined) { window.FC = {}; }\n\n(() => {\n\n  class RecipeSearchComponent extends React.Component {\n\n    constructor() {\n      super()\n      this.state = { baseUri: \"\",\n      results: [],\n      form: true,\n      offset: 0,\n      query: undefined\n      }\n      this.handleScroll = this.handleScroll.bind(this);\n    }\n\n    componentDidMount() {\n      var storedSearch = FC.dietData.getCurrentSearch();\n\n      if (storedSearch.data !== undefined) {\n        this.setState({\n          baseUri: storedSearch.base,\n          results: storedSearch.data,\n          form: false,\n          offset: storedSearch.offSet,\n          query: storedSearch.query\n        })\n      }\n\n      window.addEventListener(\"scroll\", this.handleScroll);\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener(\"scroll\", this.handleScroll);\n    }\n\n    handleScroll() {\n      const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n      const body = document.body;\n      const html = document.documentElement;\n      const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight,  html.scrollHeight, html.offsetHeight);\n      const windowBottom = windowHeight + window.pageYOffset;\n\n      if (windowBottom >= docHeight) {\n\n        var queryStr = this.state.query;\n        var offsetAmt = this.state.offset;\n        console.log(\"RSC\", offsetAmt);\n\n        $.ajax({\n          url: \"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/search?number=10&offset=\" + offsetAmt + \"&query=\" + queryStr,\n          type: 'GET',\n        \tbeforeSend: function (xhr) {\n        \t\txhr.setRequestHeader(\"X-Mashape-Key\", \"lfLi0pd5ComshP5lbLvR2GHC5uP6p1b7AOujsnP5aI9GJrDgG1\");\n            xhr.setRequestHeader(\"Accept\", \"application/json\");\n        \t}\n        })\n        .done((data) => {\n\n          FC.dietData.storeCurrentSearch(data.results, queryStr, offsetAmt, data.baseUri);\n\n          var concatRecipes = this.state.results.concat(data.results);\n\n          this.setState({\n            baseUri: data.baseUri,\n            results: concatRecipes,\n            form: false,\n            offset: this.state.offset + 10,\n            query: queryStr\n          });\n        });\n      }\n    }\n\n    callSearch(evt) {\n      evt.preventDefault();\n      var queryStr = this.queryInput.value;\n      FC.dietData.deleteCurrentSearch();\n\n      $.ajax({\n      \turl: \"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/search?number=10&offset=0&query=\" + queryStr,\n      \ttype: 'GET',\n      \tbeforeSend: function (xhr) {\n      \t\txhr.setRequestHeader(\"X-Mashape-Key\", \"lfLi0pd5ComshP5lbLvR2GHC5uP6p1b7AOujsnP5aI9GJrDgG1\");\n          xhr.setRequestHeader(\"Accept\", \"application/json\");\n      \t}\n      })\n      .done((data) => {\n\n        FC.dietData.storeCurrentSearch(data.results, queryStr, 0, data.baseUri);\n\n        this.setState({\n          baseUri: data.baseUri,\n          results: data.results,\n          form: false,\n          offset: this.state.offset + 10,\n          query: queryStr\n        });\n\n      })\n\n    }\n\n    render() {\n\n      var searchForm;\n      var searchResults;\n      var imageUrl;\n\n      if (this.state.form === true) {\n        searchForm = <form><input ref={(input) => { this.queryInput = input }} placeholder=\"Search\" /><button onClick={(evt) => { this.callSearch(evt); }}>Search</button></form>\n      } else if (this.state.form === false) {\n        imageUrl = this.state.baseUri\n        searchForm = <form><input ref={(input) => { this.queryInput = input }} placeholder=\"Search\" /><button onClick={(evt) => { this.callSearch(evt); }}>Search</button></form>\n        searchResults = <div><h1>Search results for \"{this.queryInput.value}\"</h1>\n         <ul className=\"search-results\">\n          {this.state.results.map((recipe, index) => {\n            return <li key={index}><img src={imageUrl + recipe.image} />\n            <ReactRouter.Link to={\"/recipe/\" + recipe.id}><p>{recipe.title}</p></ReactRouter.Link>\n            <p>Ready in {recipe.readyInMinutes} minutes</p></li>\n          })}\n         </ul>\n         </div>\n      }\n\n      return <div className=\"search-container\">{searchForm}{searchResults}</div>\n    }\n  }\n\n  FC.RecipeSearchComponent = RecipeSearchComponent;\n})()\n"]}