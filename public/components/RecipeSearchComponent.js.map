{"version":3,"sources":["components/RecipeSearchComponent.js"],"names":["window","FC","undefined","RecipeSearchComponent","state","baseUri","results","form","offset","query","handleScroll","bind","storedSearch","dietData","getCurrentSearch","data","setState","addEventListener","removeEventListener","windowHeight","innerHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","pageYOffset","queryStr","queryInput","value","offsetAmt","console","log","$","ajax","url","type","beforeSend","xhr","setRequestHeader","done","storeCurrentSearch","concatRecipes","concat","evt","preventDefault","deleteCurrentSearch","searchForm","searchResults","imageUrl","inputVal","input","callSearch","map","recipe","index","image","id","title","readyInMinutes","React","Component"],"mappings":"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","file":"RecipeSearchComponent.js","sourcesContent":["if (window.FC === undefined) { window.FC = {}; }\n\n(() => {\n\n  class RecipeSearchComponent extends React.Component {\n\n    constructor() {\n      super()\n      this.state = { baseUri: \"\",\n      results: [],\n      form: true,\n      offset: 0,\n      query: undefined\n      }\n      this.handleScroll = this.handleScroll.bind(this);\n    }\n\n    componentDidMount() {\n      var storedSearch = FC.dietData.getCurrentSearch();\n\n      if (storedSearch.data !== undefined) {\n        this.setState({\n          baseUri: storedSearch.baseUri,\n          results: storedSearch.data,\n          form: false,\n          offset: storedSearch.offset,\n          query: storedSearch.query\n        })\n      }\n\n      window.addEventListener(\"scroll\", this.handleScroll);\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener(\"scroll\", this.handleScroll);\n    }\n\n    handleScroll() {\n      const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n      const body = document.body;\n      const html = document.documentElement;\n      const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight,  html.scrollHeight, html.offsetHeight);\n      const windowBottom = windowHeight + window.pageYOffset;\n\n      if (windowBottom >= docHeight) {\n\n        var queryStr = this.queryInput.value;\n        var offsetAmt = this.state.offset;\n        console.log(\"RSC\", offsetAmt);\n\n        $.ajax({\n          url: \"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/search?number=10&offset=\" + offsetAmt + \"&query=\" + queryStr,\n          type: 'GET',\n        \tbeforeSend: function (xhr) {\n        \t\txhr.setRequestHeader(\"X-Mashape-Key\", \"lfLi0pd5ComshP5lbLvR2GHC5uP6p1b7AOujsnP5aI9GJrDgG1\");\n            xhr.setRequestHeader(\"Accept\", \"application/json\");\n        \t}\n        })\n        .done((data) => {\n\n          FC.dietData.storeCurrentSearch(data.results, queryStr, offsetAmt, data.baseUri);\n\n          var concatRecipes = this.state.results.concat(data.results);\n\n          this.setState({\n            baseUri: data.baseUri,\n            results: concatRecipes,\n            form: false,\n            offset: this.state.offset + 10\n          });\n        });\n      }\n    }\n\n    callSearch(evt) {\n      evt.preventDefault();\n      var queryStr = this.queryInput.value;\n      FC.dietData.deleteCurrentSearch();\n\n      $.ajax({\n      \turl: \"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/search?number=10&offset=0&query=\" + queryStr,\n      \ttype: 'GET',\n      \tbeforeSend: function (xhr) {\n      \t\txhr.setRequestHeader(\"X-Mashape-Key\", \"lfLi0pd5ComshP5lbLvR2GHC5uP6p1b7AOujsnP5aI9GJrDgG1\");\n          xhr.setRequestHeader(\"Accept\", \"application/json\");\n      \t}\n      })\n      .done((data) => {\n\n        FC.dietData.storeCurrentSearch(data.results, queryStr, 0, data.baseUri);\n\n        this.setState({\n          baseUri: data.baseUri,\n          results: data.results,\n          form: false,\n          offset: this.state.offset + 10\n        });\n\n      })\n\n    }\n\n    render() {\n\n      var searchForm;\n      var searchResults;\n      var imageUrl;\n      var inputVal;\n\n      if (this.state.query !== undefined) {\n        inputVal = this.state.query\n      }\n\n      if (this.state.form === true) {\n        searchForm = <form><input ref={(input) => { this.queryInput = input }} placeholder=\"Search\" /><button onClick={(evt) => { this.callSearch(evt); }}>Search</button></form>\n      } else if (this.state.form === false) {\n        imageUrl = this.state.baseUri\n        searchForm = <form><input defaultValue={inputVal} ref={(input) => { this.queryInput = input }} placeholder=\"Search\" /><button onClick={(evt) => { this.callSearch(evt); }}>Search</button></form>\n        searchResults = <div><h1>Search results for \"{this.queryInput.value}\"</h1>\n         <ul className=\"search-results\">\n          {this.state.results.map((recipe, index) => {\n            return <li key={index}><img src={imageUrl + recipe.image} />\n            <ReactRouter.Link to={\"/recipe/\" + recipe.id}><p>{recipe.title}</p></ReactRouter.Link>\n            <p>Ready in {recipe.readyInMinutes} minutes</p></li>\n          })}\n         </ul>\n         </div>\n      }\n\n      return <div className=\"search-container\">{searchForm}{searchResults}</div>\n    }\n  }\n\n  FC.RecipeSearchComponent = RecipeSearchComponent;\n})()\n"]}