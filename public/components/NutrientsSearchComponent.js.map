{"version":3,"sources":["components/NutrientsSearchComponent.js"],"names":["window","FC","undefined","NutrientsSearchComponent","state","form","results","offset","searchParams","query","handleScroll","bind","dietData","deleteCurrentSearch","storedSearch","getCurrentNutrientSearch","data","setState","params","addEventListener","removeEventListener","windowHeight","innerHeight","document","documentElement","offsetHeight","body","html","docHeight","Math","max","scrollHeight","clientHeight","windowBottom","pageYOffset","queryStr","offsetAmt","maxCalories","maxFat","maxCarbs","maxProtein","$","ajax","url","type","beforeSend","xhr","setRequestHeader","apiKey","mashKey","done","storeCurrentNutrientSearch","queryInput","value","concatRecipes","concat","string","evt","preventDefault","validateSearchParams","searchForm","searchResults","callSearch","input","map","recipe","index","image","id","title","React","Component"],"mappings":"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","file":"NutrientsSearchComponent.js","sourcesContent":["if (window.FC === undefined) { window.FC = {}; }\n\n(() => {\n\n  class NutrientsSearchComponent extends React.Component {\n\n    constructor() {\n      super();\n      this.state = { form: true, results: [], offset: 0, searchParams: {}, query: \"\" }\n      this.handleScroll = this.handleScroll.bind(this);\n    }\n\n    componentDidMount() {\n      FC.dietData.deleteCurrentSearch();\n      \n      var storedSearch = FC.dietData.getCurrentNutrientSearch();\n\n      if (storedSearch.data !== undefined) {\n\n        this.setState({\n          form: false,\n          results: storedSearch.data,\n          offset: storedSearch.offset,\n          searchParams: storedSearch.params,\n          query: storedSearch.query\n        });\n\n      }\n\n      window.addEventListener(\"scroll\", this.handleScroll);\n\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener(\"scroll\", this.handleScroll);\n    }\n\n    handleScroll() {\n      const windowHeight = \"innerHeight\" in window ? window.innerHeight : document.documentElement.offsetHeight;\n      const body = document.body;\n      const html = document.documentElement;\n      const docHeight = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight,  html.scrollHeight, html.offsetHeight);\n      const windowBottom = windowHeight + window.pageYOffset;\n\n      if (windowBottom >= docHeight) {\n\n        var queryStr = this.state.searchParams.queryStr;\n        var offsetAmt = this.state.offset;\n        var maxCalories = this.state.searchParams.maxCalories;\n        var maxFat = this.state.searchParams.maxFat;\n        var maxCarbs = this.state.searchParams.maxCarbs;\n        var maxProtein = this.state.searchParams.maxProtein;\n\n        $.ajax({\n          url: \"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/searchComplex?limitLicense=false\" + maxCalories + maxCarbs +  maxFat +  maxProtein + \"&number=10&offset=\" + offsetAmt + queryStr + \"&ranking=1\",\n          type: 'GET',\n        \tbeforeSend: function (xhr) {\n        \t\txhr.setRequestHeader(\"X-Mashape-Key\", FC.apiKey.mashKey);\n            xhr.setRequestHeader(\"Accept\", \"application/json\");\n        \t}\n        })\n        .done((data) => {\n\n          FC.dietData.storeCurrentNutrientSearch(this.state.searchParams, data.results, this.queryInput.value, this.state.offset);\n\n          var concatRecipes = this.state.results.concat(data.results);\n\n          this.setState({\n            form: false,\n            results: concatRecipes,\n            offset: this.state.offset + 10,\n            searchParams: this.state.searchParams\n          });\n\n        });\n      }\n    }\n\n    validateSearchParams(string, value) {\n\n      if (value === \"\" ) {\n        return \"\";\n      }\n      else {\n        return string + value;\n      }\n\n    }\n\n    callSearch(evt) {\n      evt.preventDefault();\n      var offsetAmt = \"&offset=\" + 0;\n      var queryStr = this.validateSearchParams(\"&query=\", this.queryInput.value);\n      var maxCalories = this.validateSearchParams(\"&maxCalories=\", this.maxCalories.value);\n      var maxFat = this.validateSearchParams(\"&maxFat=\", this.maxFat.value);\n      var maxCarbs = this.validateSearchParams(\"&maxCarbs=\", this.maxCarbs.value);\n      var maxProtein = this.validateSearchParams(\"&maxProtein=\", this.maxProtein.value);\n\n\n      $.ajax({\n        url: \"https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/searchComplex?limitLicense=false\" + maxCalories + maxCarbs +  maxFat + maxProtein + \"&number=10\" + offsetAmt + queryStr + \"&ranking=1\",\n        type: 'GET',\n      \tbeforeSend: function (xhr) {\n      \t\txhr.setRequestHeader(\"X-Mashape-Key\", FC.apiKey.mashKey);\n          xhr.setRequestHeader(\"Accept\", \"application/json\");\n      \t}\n      })\n      .done((data) => {\n\n        var params = {\n          queryStr: queryStr,\n          maxCalories: maxCalories,\n          maxFat: maxFat,\n          maxCarbs: maxCarbs,\n          maxProtein: maxProtein\n        }\n\n        FC.dietData.storeCurrentNutrientSearch(params, data.results, this.queryInput.value, this.state.offset)\n\n        this.setState({\n          form: false,\n          results: data.results,\n          offset: this.state.offset + 10,\n          searchParams: params,\n          query: this.queryInput.value\n        });\n\n      });\n\n    }\n\n    backToSearch() {\n      this.setState({\n        form: true,\n        searchParams: {},\n        query: \"\",\n        offset: 0\n      });\n    }\n\n    render() {\n      var searchForm;\n      var searchResults;\n\n      if (this.state.form === true) {\n        searchForm = <form className=\"react-form\" onSubmit={(evt) => { this.callSearch(evt)}}><input ref={(input) => { this.queryInput = input }} placeholder=\"Recipe Keyword\" />\n        <input ref={(input) => { this.maxCalories = input}} placeholder=\"Max Calories\" />\n        <input ref={(input) => { this.maxFat = input}} placeholder=\"Max Fat\" />\n        <input ref={(input) => { this.maxCarbs = input}} placeholder=\"Max Carbohydrates\" />\n        <input ref={(input) => { this.maxProtein = input}} placeholder=\"Max Protein\" />\n        <button>Search</button></form>\n      } else {\n\n        searchForm = <form className=\"react-form\" onSubmit={(evt) => { this.callSearch(evt)}}><input ref={(input) => { this.queryInput = input }} placeholder=\"Recipe Keyword\" />\n        <input ref={(input) => { this.maxCalories = input}} placeholder=\"Max Calories\" />\n        <input ref={(input) => { this.maxFat = input}} placeholder=\"Max Fat\" />\n        <input ref={(input) => { this.maxCarbs = input}} placeholder=\"Max Carbohydrates\" />\n        <input ref={(input) => { this.maxProtein = input}} placeholder=\"Max Protein\" />\n        <button>Search</button></form>\n        searchResults = <div><h1 className=\"react-form-h1\">Search results for \"{this.state.query}\"</h1>\n        <ul className=\"search-results\">\n          {this.state.results.map((recipe, index) => {\n            return <li key={index}><img src={recipe.image} />\n            <ReactRouter.Link to={\"/recipe/\" + recipe.id}><p>{recipe.title}</p></ReactRouter.Link></li>\n          })}\n        </ul></div>\n      }\n\n      return <div className=\"search-container\"><h1 className=\"react-form-h1\">Search Recipe By Max Nutrients Amounts</h1>\n      {searchForm}{searchResults}</div>\n    }\n  }\n\n  FC.NutrientsSearchComponent = NutrientsSearchComponent;\n\n})()\n"]}